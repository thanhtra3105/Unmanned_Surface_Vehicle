<!DOCTYPE html>
<html>
<head>
  <title>USV Dashboard</title>
  <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDl7j1gjfJ-OentAm-aqDHu81p-Kv3WHos"></script>
  <style>
    #map { height: 500px; width: 100%; }
    #panel { padding: 10px; background: #f9f9f9; }
  </style>
</head>
<body>
  <h2>ðŸš¤ USV Real-time Dashboard</h2>
  <div id="map"></div>
  <div id="panel">
    <p>Lat: <span id="lat"></span></p>
    <p>Lon: <span id="lon"></span></p>
    <p>Heading: <span id="heading"></span></p>
  </div>

  <script>
    let map, vehicle;
    function initMap() {
      map = new google.maps.Map(document.getElementById("map"), {
        center: { lat: -35.363262, lng: 149.165237 },
        zoom: 16
      });
    }

    window.onload = initMap;

    const socket = io();
    socket.on("telemetry", data => {
      document.getElementById("lat").innerText = data.lat.toFixed(6);
      document.getElementById("lon").innerText = data.lon.toFixed(6);
      document.getElementById("heading").innerText = data.heading;

      let pos = { lat: data.lat, lng: data.lon };
      if (!vehicle) {
        vehicle = new google.maps.Marker({
          position: pos,
          map: map,
          icon: "https://img.icons8.com/ios-filled/50/0000FF/ship.png"
        });
      } else {
        vehicle.setPosition(pos);
      }
      map.setCenter(pos);
    });
  </script>
</body>
</html>
